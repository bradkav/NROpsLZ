(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29712,        705]
NotebookOptionsPosition[     28838,        672]
NotebookOutlinePosition[     29192,        688]
CellTagsIndexPosition[     29149,        685]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["LUX Test Statistic (TS)",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Section",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662210044072008*^9, 3.662210088624371*^9}, {
   3.6622102745160646`*^9, 3.662210312611816*^9}, {3.662210602893345*^9, 
   3.6622106101178102`*^9}, {3.6622107943482523`*^9, 3.662210801859043*^9}, {
   3.662210952231955*^9, 3.662211000180181*^9}, {3.66221106418368*^9, 
   3.662211068196521*^9}, {3.662211105353259*^9, 3.662211192162642*^9}, {
   3.6622112697807426`*^9, 3.6622112831842403`*^9}, {3.662211442521977*^9, 
   3.662211454010805*^9}, {3.662211801228436*^9, 3.662211807930971*^9}, {
   3.662211893632246*^9, 3.662211900191637*^9}, {3.662211984796035*^9, 
   3.662212077030547*^9}, {3.662212156213916*^9, 3.662212226383341*^9}, {
   3.662212256394066*^9, 3.662212412975*^9}, {3.662212457396022*^9, 
   3.6622124915138683`*^9}, {3.662212635672284*^9, 3.662212635887431*^9}, 
   3.662212928556355*^9, {3.662212961344894*^9, 3.6622130269973087`*^9}, {
   3.6634881058183527`*^9, 3.663488213373855*^9}, {3.6634882630745*^9, 
   3.663488294326125*^9}, {3.663488329019732*^9, 3.663488336497081*^9}, {
   3.6634885380462914`*^9, 3.6634886373514833`*^9}, {3.663488725251503*^9, 
   3.66348874816076*^9}, {3.6634887984019823`*^9, 3.663488819206209*^9}, {
   3.6634888722749577`*^9, 3.663488898744567*^9}, {3.663488996569854*^9, 
   3.663489004374263*^9}, 3.6634892579563637`*^9, {3.663489306463567*^9, 
   3.663489340275462*^9}, {3.6634894023127813`*^9, 3.663489435416059*^9}, {
   3.663489473084128*^9, 3.663489486779563*^9}, {3.663489546486109*^9, 
   3.663489575689049*^9}, {3.663489616927589*^9, 3.663489644627713*^9}, {
   3.663489683986218*^9, 3.663489817562566*^9}, {3.663489852669051*^9, 
   3.6634898545785427`*^9}, {3.66348988675371*^9, 3.663489897811693*^9}, {
   3.66349255684308*^9, 3.663492579876814*^9}, {3.663492616516657*^9, 
   3.663492621414605*^9}, {3.663493710605229*^9, 3.663493716511505*^9}, {
   3.66349380453722*^9, 3.663493823959606*^9}, {3.663493867213913*^9, 
   3.6634939425006332`*^9}, {3.66349399249117*^9, 3.663494257216777*^9}, {
   3.663495710109082*^9, 3.663495722701343*^9}, {3.663495978144289*^9, 
   3.663495978243162*^9}, {3.6634975191160927`*^9, 3.6634975304338417`*^9}, {
   3.663497616266529*^9, 3.66349764223396*^9}, {3.663497782441153*^9, 
   3.6634978396772327`*^9}, {3.6634983435154943`*^9, 3.663498396247716*^9}, {
   3.6635721257147007`*^9, 3.663572170443529*^9}, 3.690041946858657*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LUXdata", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
      "\"\<LUXdata/LUX-TS.txt\>\""}], ",", " ", "\"\<Table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LUXTSInterp", " ", "=", " ", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"LUXdata", ",", " ", 
      RowBox[{"InterpolationOrder", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "TSLUX", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TSLUX", "[", 
    RowBox[{
     RowBox[{"lm_", "?", "NumericQ"}], ",", " ", 
     RowBox[{"l\[Lambda]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"LUXTSInterp", "[", 
     RowBox[{
      RowBox[{"10", "^", "lm"}], ",", " ", 
      RowBox[{"10", "^", "l\[Lambda]"}]}], "]"}], " ", "+", " ", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]], 
     RowBox[{"Abs", "[", "l\[Lambda]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662210044072008*^9, 3.662210088624371*^9}, {
   3.6622102745160646`*^9, 3.662210312611816*^9}, {3.662210602893345*^9, 
   3.6622106101178102`*^9}, {3.6622107943482523`*^9, 3.662210801859043*^9}, {
   3.662210952231955*^9, 3.662211000180181*^9}, {3.66221106418368*^9, 
   3.662211068196521*^9}, {3.662211105353259*^9, 3.662211192162642*^9}, {
   3.6622112697807426`*^9, 3.6622112831842403`*^9}, {3.662211442521977*^9, 
   3.662211454010805*^9}, {3.662211801228436*^9, 3.662211807930971*^9}, {
   3.662211893632246*^9, 3.662211900191637*^9}, {3.662211984796035*^9, 
   3.662212077030547*^9}, {3.662212156213916*^9, 3.662212226383341*^9}, {
   3.662212256394066*^9, 3.662212412975*^9}, {3.662212457396022*^9, 
   3.6622124915138683`*^9}, {3.662212635672284*^9, 3.662212635887431*^9}, 
   3.662212928556355*^9, {3.662212961344894*^9, 3.6622130269973087`*^9}, {
   3.6634881058183527`*^9, 3.663488213373855*^9}, {3.6634882630745*^9, 
   3.663488294326125*^9}, {3.663488329019732*^9, 3.663488336497081*^9}, {
   3.6634885380462914`*^9, 3.6634886373514833`*^9}, {3.663488725251503*^9, 
   3.66348874816076*^9}, {3.6634887984019823`*^9, 3.663488819206209*^9}, {
   3.6634888722749577`*^9, 3.663488898744567*^9}, {3.663488996569854*^9, 
   3.663489004374263*^9}, 3.6634892579563637`*^9, {3.663489306463567*^9, 
   3.663489340275462*^9}, {3.6634894023127813`*^9, 3.663489435416059*^9}, {
   3.663489473084128*^9, 3.663489486779563*^9}, {3.663489546486109*^9, 
   3.663489575689049*^9}, {3.663489616927589*^9, 3.663489644627713*^9}, {
   3.663489683986218*^9, 3.663489817562566*^9}, {3.663489852669051*^9, 
   3.6634898545785427`*^9}, {3.66348988675371*^9, 3.663489897811693*^9}, {
   3.66349255684308*^9, 3.663492579876814*^9}, {3.663492616516657*^9, 
   3.663492621414605*^9}, {3.663493710605229*^9, 3.663493716511505*^9}, {
   3.66349380453722*^9, 3.663493823959606*^9}, {3.663493867213913*^9, 
   3.6634939425006332`*^9}, {3.66349399249117*^9, 3.663494257216777*^9}, {
   3.663495710109082*^9, 3.663495722701343*^9}, {3.663495978144289*^9, 
   3.663495978243162*^9}, {3.6634975191160927`*^9, 3.6634975304338417`*^9}, {
   3.663497616266529*^9, 3.66349764223396*^9}, {3.663497782441153*^9, 
   3.6634978396772327`*^9}, {3.6634983435154943`*^9, 3.663498396247716*^9}, {
   3.6635721257147007`*^9, 3.663572148216032*^9}, {3.663574679626532*^9, 
   3.663574734399164*^9}, {3.663574775448271*^9, 3.6635747801057997`*^9}, {
   3.667642347146443*^9, 3.6676424484163113`*^9}, {3.667643885242835*^9, 
   3.667643886865329*^9}, {3.6678944199004393`*^9, 3.667894458006103*^9}, {
   3.667895823400153*^9, 3.667895824805023*^9}, {3.667900595996254*^9, 
   3.667900596073146*^9}, {3.690041158715246*^9, 3.690041159711409*^9}, {
   3.6900418892293463`*^9, 3.690041889883873*^9}, {3.690041943886935*^9, 
   3.690041944506825*^9}, {3.690042021972484*^9, 3.690042112352394*^9}, {
   3.690042645485301*^9, 3.690042681406684*^9}, {3.690054229373872*^9, 
   3.690054231961857*^9}, 3.69005447119108*^9, {3.6900960948624697`*^9, 
   3.690096106891361*^9}, {3.6900983005329437`*^9, 3.690098309972732*^9}, {
   3.6900990349254427`*^9, 3.6900990376387444`*^9}, {3.690553896522327*^9, 
   3.6905539016174707`*^9}, {3.697548676538157*^9, 3.697548684106324*^9}, {
   3.697548876500978*^9, 3.697548908424573*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["LUX Conversion Factors (Y)",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Section",
 CellChangeTimes->{{3.663572155367259*^9, 3.66357216809758*^9}, 
   3.6676440097258*^9, {3.69005347344284*^9, 3.690053474313272*^9}, {
   3.690095013922723*^9, 3.690095016560169*^9}}],

Cell[CellGroupData[{

Cell["Contact operators", "Subsubsection",
 CellChangeTimes->{{3.690094653842305*^9, 3.690094655653227*^9}, {
  3.690095013922819*^9, 3.690095016560313*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opvals", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", " ", "3", ",", " ", "4", ",", " ", "5", ",", " ", "6", ",", " ",
      "7", ",", " ", "8", ",", " ", "9", ",", " ", "10", ",", " ", "11"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYpp", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", " ", "\"\<_\>\"", " ", "<>",
         " ", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", "\"\<_pp.txt\>\""}], 
       ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYpn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<_\>\"", " ",
         "<>", " ", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", "\"\<_pn.txt\>\""}], 
       ",", " ", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYnn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<_\>\"", " ",
         "<>", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", "\"\<_nn.txt\>\""}], 
       ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvals"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.663572151560288*^9, 3.663572154032896*^9}, {
   3.663572195098214*^9, 3.663572408897297*^9}, 3.663572448602744*^9, {
   3.663572537012562*^9, 3.663572576455523*^9}, {3.6635726430129623`*^9, 
   3.663572673708194*^9}, {3.663572724818035*^9, 3.663572729544203*^9}, {
   3.663572918617751*^9, 3.663572923954277*^9}, {3.663573912228629*^9, 
   3.663573985621642*^9}, {3.664706185859805*^9, 3.664706214825314*^9}, {
   3.66470647691033*^9, 3.6647064864121437`*^9}, {3.667642527163123*^9, 
   3.667642575763156*^9}, 3.6676426317266817`*^9, {3.667642733831922*^9, 
   3.667642870994308*^9}, {3.667642901070669*^9, 3.667643198814114*^9}, {
   3.6676432718931828`*^9, 3.667643381206449*^9}, {3.667643423519376*^9, 
   3.6676434609379673`*^9}, {3.667643540224963*^9, 3.667643541661824*^9}, {
   3.6676435761884212`*^9, 3.667643630223321*^9}, {3.6676436916362762`*^9, 
   3.667643729767007*^9}, {3.667643795842545*^9, 3.667643845844083*^9}, {
   3.6676438886838923`*^9, 3.66764389633173*^9}, {3.667643989479814*^9, 
   3.66764402289916*^9}, {3.6676460178101673`*^9, 3.667646111932622*^9}, {
   3.690043490188406*^9, 3.690043493067238*^9}, {3.69009441979497*^9, 
   3.690094439501072*^9}, {3.6900944758898773`*^9, 3.690094514396644*^9}, {
   3.690095013922921*^9, 3.690095016560441*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LUXYintpp", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYpp", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYpp", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvals", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYintpn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYpn", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYpn", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvals", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYintnn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYnn", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYnn", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvals", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.690095013922998*^9, 3.6900950165605593`*^9}, {
  3.690553924364871*^9, 3.690553928918027*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Long range operators", "Subsubsection",
 CellChangeTimes->{{3.690094649664545*^9, 3.690094651780249*^9}, {
  3.690095013923064*^9, 3.6900950165606737`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opvalsLR", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "  ", "4", ",", " ", "5", ",", " ", "6", ",", " ", "11"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYppLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", " ", "\"\<_\>\"", " ", "<>",
         " ", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", 
        "\"\<_LR_pp.txt\>\""}], ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvalsLR"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvalsLR"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYpnLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<_\>\"", " ",
         "<>", " ", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", 
        "\"\<_LR_pn.txt\>\""}], ",", " ", "\"\<Table\>\""}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvalsLR"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvalsLR"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYnnLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LUXdata/Y_LUX_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<_\>\"", " ",
         "<>", 
        RowBox[{"ToString", "[", "j", "]"}], " ", "<>", 
        "\"\<_LR_nn.txt\>\""}], ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvalsLR"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "opvalsLR"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.663572151560288*^9, 3.663572154032896*^9}, {
   3.663572195098214*^9, 3.663572408897297*^9}, 3.663572448602744*^9, {
   3.663572537012562*^9, 3.663572576455523*^9}, {3.6635726430129623`*^9, 
   3.663572673708194*^9}, {3.663572724818035*^9, 3.663572729544203*^9}, {
   3.663572918617751*^9, 3.663572923954277*^9}, {3.663573912228629*^9, 
   3.663573985621642*^9}, {3.664706185859805*^9, 3.664706214825314*^9}, {
   3.66470647691033*^9, 3.6647064864121437`*^9}, {3.667642527163123*^9, 
   3.667642575763156*^9}, 3.6676426317266817`*^9, {3.667642733831922*^9, 
   3.667642870994308*^9}, {3.667642901070669*^9, 3.667643198814114*^9}, {
   3.6676432718931828`*^9, 3.667643381206449*^9}, {3.667643423519376*^9, 
   3.6676434609379673`*^9}, {3.667643540224963*^9, 3.667643541661824*^9}, {
   3.6676435761884212`*^9, 3.667643630223321*^9}, {3.6676436916362762`*^9, 
   3.667643729767007*^9}, {3.667643795842545*^9, 3.667643845844083*^9}, {
   3.6676438886838923`*^9, 3.66764389633173*^9}, {3.667643989479814*^9, 
   3.66764402289916*^9}, {3.6676460178101673`*^9, 3.667646111932622*^9}, {
   3.690043490188406*^9, 3.690043493067238*^9}, {3.69009441979497*^9, 
   3.690094439501072*^9}, {3.6900944758898773`*^9, 3.6900945646686497`*^9}, {
   3.690095013923139*^9, 3.690095016560791*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LUXYintppLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYppLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYppLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvalsLR", "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvalsLR", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYintpnLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYpnLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYpnLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvalsLR", "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvalsLR", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LUXYintnnLR", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LUXYnnLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LUXYnnLR", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvalsLR", " ", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", 
       RowBox[{"Length", "[", "opvalsLR", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.690094728127803*^9, 3.69009477204529*^9}, {
  3.690095013923205*^9, 3.6900950165609093`*^9}, {3.690553933788313*^9, 
  3.6905539394748898`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "YLUX", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"YLUX", "[", 
      RowBox[{"type_", "?", "StringQ"}], "]"}], "[", 
     RowBox[{"i1_", ",", " ", "i2_"}], "]"}], "[", 
    RowBox[{"N1_", ",", " ", "N2_"}], "]"}], "[", 
   RowBox[{"m_", "?", "NumericQ"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"type", " ", "\[Equal]", " ", "\"\<Contact\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iop1", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"opvals", ",", "i1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"iop2", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"opvals", ",", "i2"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintpp", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintpn", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintpn", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintnn", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iop1", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"opvalsLR", ",", "i1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"iop2", " ", "=", " ", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"opvalsLR", ",", "i2"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintppLR", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintpnLR", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintpnLR", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"LUXYintnnLR", "[", 
           RowBox[{"[", 
            RowBox[{"iop1", ",", "iop2"}], "]"}], "]"}], "[", "m", "]"}], 
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{{3.663572151560288*^9, 3.663572154032896*^9}, {
   3.663572195098214*^9, 3.663572408897297*^9}, 3.663572448602744*^9, {
   3.663572537012562*^9, 3.663572576455523*^9}, {3.6635726430129623`*^9, 
   3.663572673708194*^9}, {3.663572724818035*^9, 3.663572729544203*^9}, {
   3.663572918617751*^9, 3.663572923954277*^9}, {3.663573912228629*^9, 
   3.663573985621642*^9}, {3.664706185859805*^9, 3.664706214825314*^9}, {
   3.66470647691033*^9, 3.6647064864121437`*^9}, {3.667642527163123*^9, 
   3.667642575763156*^9}, 3.6676426317266817`*^9, {3.667642733831922*^9, 
   3.667642870994308*^9}, {3.667642901070669*^9, 3.667643198814114*^9}, {
   3.6676432718931828`*^9, 3.667643381206449*^9}, {3.667643423519376*^9, 
   3.6676434609379673`*^9}, {3.667643540224963*^9, 3.667643541661824*^9}, {
   3.6676435761884212`*^9, 3.667643630223321*^9}, {3.6676436916362762`*^9, 
   3.667643729767007*^9}, {3.667643795842545*^9, 3.667643845844083*^9}, {
   3.6676438886838923`*^9, 3.66764389633173*^9}, {3.667643989479814*^9, 
   3.66764402289916*^9}, {3.6676460178101673`*^9, 3.667646111932622*^9}, {
   3.690043490188406*^9, 3.690043493067238*^9}, {3.69009441979497*^9, 
   3.690094439501072*^9}, {3.6900944758898773`*^9, 3.690094514396644*^9}, {
   3.690094575391944*^9, 3.6900946613522243`*^9}, {3.690094776894361*^9, 
   3.6900949156954947`*^9}, 3.6900949687712183`*^9, {3.690095013923273*^9, 
   3.6900950165609903`*^9}, {3.690096112033004*^9, 3.690096128640113*^9}, {
   3.6900962375668297`*^9, 3.690096278366384*^9}, {3.6905539433287983`*^9, 
   3.6905539569032927`*^9}, {3.697548628540244*^9, 3.6975486332529697`*^9}, {
   3.6975486885496264`*^9, 3.697548691982082*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 781},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2514, 35, 65, "Section",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[3097, 59, 4546, 80, 150, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[7680, 144, 292, 5, 65, "Section"],
Cell[CellGroupData[{
Cell[7997, 153, 157, 2, 35, "Subsubsection"],
Cell[8157, 157, 3634, 79, 199, "Input"],
Cell[11794, 238, 2896, 83, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14727, 326, 162, 2, 35, "Subsubsection"],
Cell[14892, 330, 3575, 80, 233, "Input"],
Cell[18470, 412, 2976, 84, 216, "Input"],
Cell[21449, 498, 7361, 170, 335, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
