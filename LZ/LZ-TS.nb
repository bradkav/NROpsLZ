(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16927,        413]
NotebookOptionsPosition[     16279,        388]
NotebookOutlinePosition[     16633,        404]
CellTagsIndexPosition[     16590,        401]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["LUX-Zeplin Test Statistic (TS)",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662210044072008*^9, 3.662210088624371*^9}, {
   3.6622102745160646`*^9, 3.662210312611816*^9}, {3.662210602893345*^9, 
   3.6622106101178102`*^9}, {3.6622107943482523`*^9, 3.662210801859043*^9}, {
   3.662210952231955*^9, 3.662211000180181*^9}, {3.66221106418368*^9, 
   3.662211068196521*^9}, {3.662211105353259*^9, 3.662211192162642*^9}, {
   3.6622112697807426`*^9, 3.6622112831842403`*^9}, {3.662211442521977*^9, 
   3.662211454010805*^9}, {3.662211801228436*^9, 3.662211807930971*^9}, {
   3.662211893632246*^9, 3.662211900191637*^9}, {3.662211984796035*^9, 
   3.662212077030547*^9}, {3.662212156213916*^9, 3.662212226383341*^9}, {
   3.662212256394066*^9, 3.662212412975*^9}, {3.662212457396022*^9, 
   3.6622124915138683`*^9}, {3.662212635672284*^9, 3.662212635887431*^9}, 
   3.662212928556355*^9, {3.662212961344894*^9, 3.6622130269973087`*^9}, {
   3.6634881058183527`*^9, 3.663488213373855*^9}, {3.6634882630745*^9, 
   3.663488294326125*^9}, {3.663488329019732*^9, 3.663488336497081*^9}, {
   3.6634885380462914`*^9, 3.6634886373514833`*^9}, {3.663488725251503*^9, 
   3.66348874816076*^9}, {3.6634887984019823`*^9, 3.663488819206209*^9}, {
   3.6634888722749577`*^9, 3.663488898744567*^9}, {3.663488996569854*^9, 
   3.663489004374263*^9}, 3.6634892579563637`*^9, {3.663489306463567*^9, 
   3.663489340275462*^9}, {3.6634894023127813`*^9, 3.663489435416059*^9}, {
   3.663489473084128*^9, 3.663489486779563*^9}, {3.663489546486109*^9, 
   3.663489575689049*^9}, {3.663489616927589*^9, 3.663489644627713*^9}, {
   3.663489683986218*^9, 3.663489817562566*^9}, {3.663489852669051*^9, 
   3.6634898545785427`*^9}, {3.66348988675371*^9, 3.663489897811693*^9}, {
   3.66349255684308*^9, 3.663492579876814*^9}, {3.663492616516657*^9, 
   3.663492621414605*^9}, {3.663493710605229*^9, 3.663493716511505*^9}, {
   3.66349380453722*^9, 3.663493823959606*^9}, {3.663493867213913*^9, 
   3.6634939425006332`*^9}, {3.66349399249117*^9, 3.663494257216777*^9}, {
   3.663495710109082*^9, 3.663495722701343*^9}, {3.663495978144289*^9, 
   3.663495978243162*^9}, {3.6634975191160927`*^9, 3.6634975304338417`*^9}, {
   3.663497616266529*^9, 3.66349764223396*^9}, {3.663497782441153*^9, 
   3.6634978396772327`*^9}, {3.6634983435154943`*^9, 3.663498396247716*^9}, {
   3.6635721257147007`*^9, 3.663572170443529*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
      "\"\<LZdata/LZ-TS.txt\>\""}], ",", " ", "\"\<Table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xval", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yval", " ", "=", " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"zval", " ", "=", " ", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbins", " ", "=", " ", "501"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"zval", "[", 
      RowBox[{"[", 
       RowBox[{"j", " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "*", "nbins"}]}], "]"}], "]"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "nbins"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nbins"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xval", " ", "=", " ", 
   RowBox[{"xval", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", 
      RowBox[{"nbins", "^", "2"}], ";;", "nbins"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yval", " ", "=", " ", 
   RowBox[{"yval", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "nbins"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TSInterp", "=", " ", 
    RowBox[{"ListInterpolation", "[", 
     RowBox[{"data1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"xval", ",", " ", "yval"}], "}"}], ",", " ", 
      RowBox[{"InterpolationOrder", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LZTS", "[", 
    RowBox[{"lm_", ",", " ", "l\[Lambda]_"}], "]"}], ":=", 
   RowBox[{"TSInterp", "[", 
    RowBox[{
     RowBox[{"10", "^", "lm"}], ",", " ", 
     RowBox[{"10", "^", "l\[Lambda]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662210044072008*^9, 3.662210088624371*^9}, {
   3.6622102745160646`*^9, 3.662210312611816*^9}, {3.662210602893345*^9, 
   3.6622106101178102`*^9}, {3.6622107943482523`*^9, 3.662210801859043*^9}, {
   3.662210952231955*^9, 3.662211000180181*^9}, {3.66221106418368*^9, 
   3.662211068196521*^9}, {3.662211105353259*^9, 3.662211192162642*^9}, {
   3.6622112697807426`*^9, 3.6622112831842403`*^9}, {3.662211442521977*^9, 
   3.662211454010805*^9}, {3.662211801228436*^9, 3.662211807930971*^9}, {
   3.662211893632246*^9, 3.662211900191637*^9}, {3.662211984796035*^9, 
   3.662212077030547*^9}, {3.662212156213916*^9, 3.662212226383341*^9}, {
   3.662212256394066*^9, 3.662212412975*^9}, {3.662212457396022*^9, 
   3.6622124915138683`*^9}, {3.662212635672284*^9, 3.662212635887431*^9}, 
   3.662212928556355*^9, {3.662212961344894*^9, 3.6622130269973087`*^9}, {
   3.6634881058183527`*^9, 3.663488213373855*^9}, {3.6634882630745*^9, 
   3.663488294326125*^9}, {3.663488329019732*^9, 3.663488336497081*^9}, {
   3.6634885380462914`*^9, 3.6634886373514833`*^9}, {3.663488725251503*^9, 
   3.66348874816076*^9}, {3.6634887984019823`*^9, 3.663488819206209*^9}, {
   3.6634888722749577`*^9, 3.663488898744567*^9}, {3.663488996569854*^9, 
   3.663489004374263*^9}, 3.6634892579563637`*^9, {3.663489306463567*^9, 
   3.663489340275462*^9}, {3.6634894023127813`*^9, 3.663489435416059*^9}, {
   3.663489473084128*^9, 3.663489486779563*^9}, {3.663489546486109*^9, 
   3.663489575689049*^9}, {3.663489616927589*^9, 3.663489644627713*^9}, {
   3.663489683986218*^9, 3.663489817562566*^9}, {3.663489852669051*^9, 
   3.6634898545785427`*^9}, {3.66348988675371*^9, 3.663489897811693*^9}, {
   3.66349255684308*^9, 3.663492579876814*^9}, {3.663492616516657*^9, 
   3.663492621414605*^9}, {3.663493710605229*^9, 3.663493716511505*^9}, {
   3.66349380453722*^9, 3.663493823959606*^9}, {3.663493867213913*^9, 
   3.6634939425006332`*^9}, {3.66349399249117*^9, 3.663494257216777*^9}, {
   3.663495710109082*^9, 3.663495722701343*^9}, {3.663495978144289*^9, 
   3.663495978243162*^9}, {3.6634975191160927`*^9, 3.6634975304338417`*^9}, {
   3.663497616266529*^9, 3.66349764223396*^9}, {3.663497782441153*^9, 
   3.6634978396772327`*^9}, {3.6634983435154943`*^9, 3.663498396247716*^9}, {
   3.6635721257147007`*^9, 3.663572148216032*^9}, {3.663574679626532*^9, 
   3.663574734399164*^9}, {3.663574775448271*^9, 3.6635747801057997`*^9}, {
   3.667642347146443*^9, 3.6676424484163113`*^9}, {3.667643885242835*^9, 
   3.667643886865329*^9}, {3.6678944199004393`*^9, 3.667894458006103*^9}, {
   3.667895823400153*^9, 3.667895824805023*^9}, {3.667900595996254*^9, 
   3.667900596073146*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["LUX-Zeplin Conversion Factors (Y)",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.663572155367259*^9, 3.66357216809758*^9}, 
   3.6676440097258*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opvals", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", " ", "3", ",", " ", "4", ",", " ", "5", ",", " ", "6", ",", " ",
      "7", ",", " ", "8", ",", " ", "9", ",", " ", "10", ",", " ", "11"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LZYpp", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LZdata/Y_LZ_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", "\"\<_pp.txt\>\""}], 
       ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LZYpn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
        "\"\<LZdata/Y_LZ_\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", 
        RowBox[{"ToString", "[", "i", "]"}], " ", "<>", "\"\<_pn.txt\>\""}], 
       ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "opvals"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LZYnn", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], " ", "<>", " ", 
         "\"\<LZdata/Y_LZ_\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", 
         RowBox[{"ToString", "[", "i", "]"}], " ", "<>", "\"\<_nn.txt\>\""}], 
        ",", " ", "\"\<Table\>\""}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "opvals"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yintpp", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LZYpp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LZYpp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yintpn", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LZYpn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"LZYpn", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"InterpolationOrder", "\[Rule]", 
        RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yintnn", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListInterpolation", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LZYnn", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"LZYnn", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"InterpolationOrder", "\[Rule]", 
         RowBox[{"{", "1", "}"}]}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "opvals", "]"}]}], " ", "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"YLZ", "[", "i_", "]"}], "[", 
    RowBox[{"N1_", ",", " ", "N2_"}], "]"}], "[", "m_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iop", " ", "=", " ", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"opvals", ",", "i"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Yintpp", "[", 
         RowBox[{"[", "iop", "]"}], "]"}], "[", "m", "]"}], "]"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N1", " ", "\[Equal]", " ", "\"\<p\>\""}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Yintpn", "[", 
         RowBox[{"[", "iop", "]"}], "]"}], "[", "m", "]"}], "]"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"N2", " ", "\[Equal]", "\"\<p\>\""}], ")"}]}], ",", " ", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Yintpn", "[", 
         RowBox[{"[", "iop", "]"}], "]"}], "[", "m", "]"}], "]"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"N1", " ", "\[Equal]", " ", "\"\<n\>\""}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"N2", " ", "\[Equal]", "\"\<n\>\""}], ")"}]}], ",", " ", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"Yintnn", "[", 
         RowBox[{"[", "iop", "]"}], "]"}], "[", "m", "]"}], "]"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.663572151560288*^9, 3.663572154032896*^9}, {
   3.663572195098214*^9, 3.663572408897297*^9}, 3.663572448602744*^9, {
   3.663572537012562*^9, 3.663572576455523*^9}, {3.6635726430129623`*^9, 
   3.663572673708194*^9}, {3.663572724818035*^9, 3.663572729544203*^9}, {
   3.663572918617751*^9, 3.663572923954277*^9}, {3.663573912228629*^9, 
   3.663573985621642*^9}, {3.664706185859805*^9, 3.664706214825314*^9}, {
   3.66470647691033*^9, 3.6647064864121437`*^9}, {3.667642527163123*^9, 
   3.667642575763156*^9}, 3.6676426317266817`*^9, {3.667642733831922*^9, 
   3.667642870994308*^9}, {3.667642901070669*^9, 3.667643198814114*^9}, {
   3.6676432718931828`*^9, 3.667643381206449*^9}, {3.667643423519376*^9, 
   3.6676434609379673`*^9}, {3.667643540224963*^9, 3.667643541661824*^9}, {
   3.6676435761884212`*^9, 3.667643630223321*^9}, {3.6676436916362762`*^9, 
   3.667643729767007*^9}, {3.667643795842545*^9, 3.667643845844083*^9}, {
   3.6676438886838923`*^9, 3.66764389633173*^9}, {3.667643989479814*^9, 
   3.66764402289916*^9}, {3.6676460178101673`*^9, 3.667646111932622*^9}}]
}, Open  ]]
},
WindowSize->{720, 780},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2496, 35, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[3079, 59, 5190, 116, 250, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[8306, 180, 254, 5, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[8563, 187, 7700, 198, 471, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
